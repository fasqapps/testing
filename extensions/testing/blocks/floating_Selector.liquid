<link rel="stylesheet" href="{{ 'marketSelector.css' | asset_url }}">
<script src="{{ 'marketSelector.js' | asset_url }}" async></script>
<script src="{{ 'floating.js' | asset_url }}" async></script>
<script src="{{ 'countryData.js' | asset_url }}" defer></script>
<style>
  .floating_popup_container {
    display: flex;
    position: fixed;
    height: fit-content;
    width: fit-content !important;
    top: 90vh;
    right: 3%;
    bottom: 0;
    left: 0;
    z-index: 999999;
  }
  #floating_countrySearchBar {
    position: sticky;
    top: 0;
    z-index: 10;
    border: none;
  }

  .floating_dropdown_content {
    /* display: none; */
    position: absolute;
    box-shadow: 0 8px 16px 0 rgba(0, 0, 0, 0.2);
    z-index: 99999999999999;
    max-height: 200px;
    max-width: 100%;
    overflow-y: auto;
    margin-left: 11px;
    top: auto;
    bottom: calc(100% + 10px);
    opacity: 0;
    visibility: hidden;
    transform: translateY(-20px) scale(0.95);
    transition: opacity 0.4s ease, transform 0.4s ease;
  }

  .floating_dropdown_content a {
    padding: 12px 16px;
    text-decoration: none;
    display: flex;
    align-items: center;
    justify-content: flex-start;
    display: block;
    opacity: 0;
    transform: translateX(-20px);
    transition: opacity 0.3s ease, transform 0.3s ease;
  }

  .floating_dropdown {
    margin-left: 8px;
    display: flex;
    width: 150px;
    cursor: pointer;
    justify-content: space-around;
    border-radius: 10px;
    border: 1px solid #cccccc;
    padding: 5px;
    height: 40px;
  }

  .zeom_dropbtnfloating {
    border-radius: 8px;
  }

  #floating_dropdownContent::-webkit-scrollbar-track {
    -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);
    border-radius: 10px;
    background-color: #f5f5f5;
  }

  #floating_dropdownContent::-webkit-scrollbar {
    width: 12px;
    background-color: #f5f5f5;
  }

  #floating_dropdownContent::-webkit-scrollbar-thumb {
    border-radius: 10px;
    -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);
    background-color: #808080;
  }

  .zeom_floating_country_code {
    margin-top: 3px;
  }

  .zeom_currency_code_floating {
    margin-top: 3px;
  }

  .icon-dropdown-floating {
    height: 0.6rem;
    margin-top: 12px;
    transition: transform 0.3s ease;
  }

  .zeom_countryNameDropFloating {
    margin-left: 10px;
  }

  .floating_currency_code {
    margin: auto 5px auto 8px;
  }

  .floating_currency_symbol {
    margin-left: 5px;
  }

  #floatingLanguageSelectorBtn {
    cursor: pointer;
    border-radius: 10px;
    margin-left: 11px;
    padding: 7px;
    height: 40px;
    background-color: white;
    border: 1px solid #cccccc;
    width: 120px;
    align-items: center;
    justify-content: space-between;
  }

  #floatingSelectorlanguageList {
    display: none;
    position: absolute;
    width: 120px;
    border: 1px solid #ccc;
    padding: 10px;
    list-style-type: none;
    max-height: 150px;
    overflow-y: auto;
    z-index: 999999999999;
    margin-left: 11px;
    top: auto;
    bottom: calc(100% + 10px);
  }
  #floatingSelectorlanguageList::-webkit-scrollbar {
    width: 8px;
  }

  #floatingSelectorlanguageList::-webkit-scrollbar-thumb {
    background-color: #888;
    border-radius: 10px;
  }

  #floatingSelectorlanguageList::-webkit-scrollbar-thumb:hover {
    background-color: #555;
  }

  #floatingSelectorlanguageList a {
    color: black;
    text-decoration: none;
  }

  #floatingSelectorlanguageList a:hover {
    text-decoration: underline;
  }

  .floatingSelectorlanguageChoice {
    margin-top: 10px;
  }

  .floating-icon-lng {
    height: 0.6rem;
    transition: transform 0.4s ease;
  }

  @media screen and (max-width: 800px) {
    .floating_popup_container {
      top: 85vh;
    }

    .floating_dropdown {
      margin-left: 8px;
      width: 130px;
    }

    #floatingLanguageSelectorBtn {
      margin-left: 8px;
      width: 100px;
    }
  }
</style>

<input
  type="hidden"
  id="floatingmetafeildurl"
  name="metafeildurl"
  value="{{ shop.metafields.incovo.ztore_glob }}"
>
<span class="hiddden market_data_Presence_floating" data-value="{{ shop.metafields.incovo.ZoisMarketEnambled }}"></span>
<input
  type="hidden"
  id="floating_country_hidden"
  name="Country"
  value="{{ block.settings.zeom_floating_selector }}"
>

<div class="floating_popup_container">
  <div class="CountryContainer_div">
    {% if block.settings.zeom_floating_selector %}
      <div
        class="floating_dropdown_content"
        id="floating_dropdownContent"
        style="background-color: {{ block.settings.floating_dropdown_background_color }};"
      >
        <input
          type="text"
          id="floating_countrySearchBar"
          placeholder="Search for a country..."
          style="width: 100%; padding: 10px; box-sizing: border-box; background-color: {{ block.settings.floating_dropdown_background_color }}; color: {{ block.settings.dropdown_font_color_floating }};"
        >
        {% for country in localization.available_countries %}
          <a
            tabindex="-1"
            value="{{ country.iso_code }}"
            style="color: {{ block.settings.dropdown_font_color_floating }}; cursor: pointer;"
            onmouseover="this.style.color='{{ block.settings.dropdown_hover_color_floating }}'"
            onmouseout="this.style.color='{{ block.settings.dropdown_font_color_floating }}'"
          >
            {% if country.iso_code == 'AC' or country.iso_code == 'TA' %}
              <img
                src="{{ 'zowwselectoracta.png' | asset_url }}"
                alt="Alt Text"
                height="25"
                width="25"
                loading="lazy"
              >
              {% if block.settings.floating_currency_code_Setting %}
                <span class="floating_currency_code"> {{ country.currency.iso_code }}</span> |
              {% endif %}

              {% if block.settings.zeom_currency_code_floating %}
                <span class="floating_currency_symbol">({{ country.currency.symbol }})</span>
              {% endif %}

              <span class="floating_currency_symbol">({{ country.currency.symbol }})</span>
              {% if block.settings.zeom_country_name_floating %}
                <span class="zeom_countryNameDropFloating">{{ country.name }}</span>
              {% endif %}
            {% else %}
              {{ country | image_url: width: 25 | image_tag }}

              {% if block.settings.floating_currency_code_Setting %}
                <span class="floating_currency_code"> {{ country.currency.iso_code }}</span> |
              {% endif %}

              {% if block.settings.zeom_currency_code_floating %}
                <span class="floating_currency_symbol">({{ country.currency.symbol }})</span>
              {% endif %}

              {% if block.settings.zeom_country_name_floating %}
                <span class="zeom_countryNameDropFloating">{{ country.name }}</span>
              {% endif %}
            {% endif %}
            {% if section.settings.show_currency %}
              ({{ country.currency.iso_code }}
              {{ country.currency.symbol }})
            {% endif %}
          </a>
        {% endfor %}
      </div>
      <div
        class="floating_dropdown"
        id="floating_dropdown"
        style="background-color: {{ block.settings.Floating_background_Color }}"
      >
        <img
          src="{{ localization.country | image_url }}"
          class="zeom_dropbtnfloating"
          id="zeom_blockFloatingID"
          alt="Flag Image"
          width="32"
          height="32"
          loading="lazy"
          style="cursor:pointer;"
        >
        {% if block.settings.zeom_floating_country_code %}
          <span class="zeom_floating_country_code" style="color: {{ block.settings.Country_text_Color_floating }};">
            {{- localization.country.iso_code -}}
          </span>
        {% endif %}

        {% if block.settings.zeom_currency_code_floating %}
          <span class="zeom_currency_code_floating" style="color: {{ block.settings.Country_text_Color_floating }};"
            >({{ localization.country.currency.symbol }})</span
          >
        {% endif %}

        <svg
          aria-hidden="true"
          focusable="false"
          class="icon icon-dropdown-floating"
          viewBox="0 0 10 6"
          style="color: {{ block.settings.Country_text_Color_floating }};"
        >
            <path fill-rule="evenodd" clip-rule="evenodd" d="M9.354.646a.5.5 0 00-.708 0L5 4.293 1.354.646a.5.5 0 00-.708.708l4 4a.5.5 0 00.708 0l4-4a.5.5 0 000-.708z" fill="currentColor">
          </path>
        </svg>
      </div>
    {% endif %}
  </div>
  <div class="LaguageContainer_div">
    <localization-form class="lng_form_floating">
      {% form 'localization' %}
        <button
          id="floatingLanguageSelectorBtn"
          type="button"
          class="border"
          tabindex="-1"
          onclick="floatingrotateIconLng()"
          style="
            background-color: {{ block.settings.Floating_background_Color }}; color: {{ block.settings.Country_text_Color_floating }}; {% if block.settings.zeom_lan_selector_floating %} display: flex; {% else %}
              display: none;
            {% endif %}
          "
        >
          {% if block.settings.floating_laguage_name_Setting %}
            {{ localization.language.endonym_name | capitalize }}
          {% else %}
            {{ localization.language.iso_code | capitalize }}
          {% endif %}

          <svg
            aria-hidden="true"
            focusable="false"
            role="presentation"
            class="icon floating-icon-lng"
            viewBox="0 0 10 6"
          >
            <path fill-rule="evenodd" clip-rule="evenodd" d="M9.354.646a.5.5 0 00-.708 0L5 4.293 1.354.646a.5.5 0 00-.708.708l4 4a.5.5 0 00.708 0l4-4a.5.5 0 000-.708z" fill="currentColor">
          </svg>
        </button>
        <ul
          id="floatingSelectorlanguageList"
          role="list"
          style="display: none; background-color: {{ block.settings.floating_dropdown_background_color }};"
        >
          {% for language in localization.available_languages %}
            <li class="floatingSelectorlanguageChoice" tabindex="-1">
              <a
                href="#"
                {% if language.iso_code == localization.language.iso_code %}
                  style="cursor: pointer; color: {{ block.settings.dropdown_font_color_floating }};" aria-current="true"
                {% endif %}
                hreflang="{{ language.iso_code }}"
                lang="{{ language.iso_code }}"
                data-value="{{ language.iso_code }}"
                style="color: {{ block.settings.dropdown_font_color_floating }};"
                onmouseover="this.style.color='{{ block.settings.dropdown_hover_color_floating }}'"
                onmouseout="this.style.color='{{ block.settings.dropdown_font_color_floating }}'"
              >
                {% if block.settings.floating_laguage_name_Setting %}
                  {{ language.endonym_name | capitalize }}
                {% else %}
                  {{ language.iso_code | capitalize }}
                {% endif %}
              </a>
            </li>
          {% endfor %}
        </ul>
        <input
          type="hidden"
          name="language_code"
          value="{{ localization.language.iso_code }}"
        >
      {% endform %}
    </localization-form>
  </div>
</div>




{% schema %}
{
  "name": "Floating Selector",
  "target": "body",
  "class": "floating_popup",

  "settings": [
    {
      "type": "checkbox",
      "id": "zeom_floating_selector",
      "label": "Show Country Selector",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "zeom_lan_selector_floating",
      "label": "Show Language Selector",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "floating_laguage_name_Setting",
      "label": "Show Language Name",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "zeom_floating_country_code",
      "label": "Show Country Code",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "zeom_currency_code_floating",
      "label": "Show Country Currency Symbol",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "zeom_country_name_floating",
      "label": "Show Country Name Dropdown",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "floating_currency_code_Setting",
      "label": "Show Country Currency Code Dropdown",
      "default": true
    },
    {
      "type": "color",
      "id": "Floating_background_Color",
      "label": "Selector Background Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "Country_text_Color_floating",
      "label": "Selector Font Color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "floating_dropdown_background_color",
      "label": "Dropdown Background Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "dropdown_font_color_floating",
      "label": "Dropdown Font Color",
      "default": "#000000"
    },

    {
      "type": "color",
      "id": "dropdown_hover_color_floating",
      "label": "Dropdown Hover Color",
      "default": "#f1f1f1"
    }
  ]
}
{% endschema %}
